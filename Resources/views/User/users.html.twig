{% extends 'BkstgCoreBundle::layout.html.twig' %}

{% block title %}Users{% endblock %}

{% block description %}
  Here you will find contact information for all users currently registered with
  this backstage.
{% endblock %}

{% block content %}
  {# only an editor can add new users #}
  <div class="panel panel-default">
    {% if is_granted("ROLE_EDITOR", null) %}
        <div class="panel-body">
          <a class="btn btn-default" href="{{ path('bkstg_user_add_user') }}">
            <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> Add new user
          </a>
        </div>
    {% endif %}
  </div>

  <div class="users-list">
    <div class="row">
      {% for user in users %}
        <div class="col-sm-4 user-wrapper">
          <div class="panel panel-default">
            <div class="panel-heading text-center">
              <a href="{{ url('bkstg_user_view_user', { 'user': user.id }) }}">
                <img width="144" height="144" class="img-thumbnail" src="{{ user.profileimageurl }}" alt="{{ user.username }}'s profile image" border="0" />
              </a>
            </div>
            <div class="panel-body">
              <a href="{{ url('bkstg_user_view_user', { 'user': user.id }) }}">
                <strong>{{ user.firstname }} {{ user.lastname }}</strong><br />
              </a>
              <a href="mailto:{{ user.email }}">{{ user.email }}</a><br />
              {% if user.phonehome %}
                {{ user.phonehome }}<br />
              {% endif %}
              {% if user.phonemobile %}
                {{ user.phonemobile }}<br />
              {% endif %}
              {% if user.positions %}
                <ul class="list-unstyled">
                  {% for position in user.positions %}
                    <li><strong>{{ position.role }}</strong> ({{ position.designation }})</li>
                  {% endfor %}
                </ul>
              {% endif %}
            </div>
            {% if is_granted('ROLE_EDITOR') %}
              <div class="panel-footer text-center">
                <a class="btn btn-default" href="{{ url('bkstg_user_edit_user', { 'user': user.id }) }}">
                  <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span> edit
                </a>
                <a class="btn btn-danger" href="{{ url('bkstg_user_delete_user', { 'user': user.id }) }}">
                  <span class="glyphicon glyphicon-remove" aria-hidden="true"></span> deactivate
                </a>
              </div>
            {% endif %}
          </div>
        </div>
        {% if loop.index is divisible by(3) %}
          </div><div class="row">
        {% endif %}
      {% endfor %}
    </div>
  </div>

  {# render post paginator #}
  {{ knp_pagination_render(users) }}
{% endblock %}
